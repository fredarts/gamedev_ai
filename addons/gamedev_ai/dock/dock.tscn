[gd_scene load_steps=2 format=3]

[ext_resource type="Script" path="res://addons/gamedev_ai/dock/dock.gd" id="1"]

[node name="GamedevAI" type="VBoxContainer"]
script = ExtResource("1")

[node name="TTSPlayer" type="AudioStreamPlayer" parent="."]
unique_name_in_owner = true

[node name="TabContainer" type="TabContainer" parent="."]
layout_mode = 2
size_flags_vertical = 3

[node name="Chat" type="VBoxContainer" parent="TabContainer"]
layout_mode = 2

[node name="ChatHeaderHBox" type="HBoxContainer" parent="TabContainer/Chat"]
layout_mode = 2
alignment = 0

[node name="ChatPresetSelector" type="OptionButton" parent="TabContainer/Chat/ChatHeaderHBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
tooltip_text = "Select an AI behavior preset"

[node name="Spacer" type="Control" parent="TabContainer/Chat/ChatHeaderHBox"]
layout_mode = 2
size_flags_horizontal = 3

[node name="FontSizeMinusBtn" type="Button" parent="TabContainer/Chat/ChatHeaderHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "A-"
tooltip_text = "Decrease font size"

[node name="FontSizePlusBtn" type="Button" parent="TabContainer/Chat/ChatHeaderHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "A+"
tooltip_text = "Increase font size"

[node name="NewChatButton" type="Button" parent="TabContainer/Chat/ChatHeaderHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "New Chat"
tooltip_text = "Start a new chat session, clearing the current history"

[node name="HistoryButton" type="MenuButton" parent="TabContainer/Chat/ChatHeaderHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "History"
tooltip_text = "View and load past chat sessions"

[node name="OutputDisplay" type="RichTextLabel" parent="TabContainer/Chat"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
bbcode_enabled = true
fit_content = false
scroll_following = true
selection_enabled = true

[node name="SelectionStatus" type="Label" parent="TabContainer/Chat"]
unique_name_in_owner = true
layout_mode = 2
horizontal_alignment = 2
text = "No selection"

[node name="TTSPlayerContainer" type="VBoxContainer" parent="TabContainer/Chat"]
unique_name_in_owner = true
layout_mode = 2

[node name="TTSControlsHBox" type="HBoxContainer" parent="TabContainer/Chat/TTSPlayerContainer"]
layout_mode = 2

[node name="TTSPlayBtn" type="Button" parent="TabContainer/Chat/TTSPlayerContainer/TTSControlsHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "‚ñ∂ Read Aloud"
tooltip_text = "Play AI text-to-speech narration"

[node name="TTSStopBtn" type="Button" parent="TabContainer/Chat/TTSPlayerContainer/TTSControlsHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "‚èπ"
tooltip_text = "Stop audio"
disabled = true

[node name="TTSSeekSlider" type="HSlider" parent="TabContainer/Chat/TTSPlayerContainer/TTSControlsHBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 4
step = 0.1
tooltip_text = "Scrub through the audio timeline"

[node name="TTSSpeedSelector" type="OptionButton" parent="TabContainer/Chat/TTSPlayerContainer/TTSControlsHBox"]
unique_name_in_owner = true
layout_mode = 2
tooltip_text = "Adjust playback speed"

[node name="ActionsContainer" type="HBoxContainer" parent="TabContainer/Chat"]
layout_mode = 2

[node name="RefactorBtn" type="Button" parent="TabContainer/Chat/ActionsContainer"]
layout_mode = 2
text = "Refactor"
tooltip_text = "Refactor the currently selected code in the editor"

[node name="FixBtn" type="Button" parent="TabContainer/Chat/ActionsContainer"]
layout_mode = 2
text = "Fix"
tooltip_text = "Propose a fix for errors in the currently selected code"

[node name="ExplainBtn" type="Button" parent="TabContainer/Chat/ActionsContainer"]
layout_mode = 2
text = "Explain"
tooltip_text = "Explain how the currently selected code works"

[node name="UndoBtn" type="Button" parent="TabContainer/Chat/ActionsContainer"]
layout_mode = 2
text = "Undo Last"
tooltip_text = "Undo the last AI action batch"

[node name="FixConsoleBtn" type="Button" parent="TabContainer/Chat/ActionsContainer"]
layout_mode = 2
text = "Fix Console"
tooltip_text = "Analyze latest console errors and propose fixes"

[node name="ExecutePlanBtn" type="Button" parent="TabContainer/Chat/ActionsContainer"]
unique_name_in_owner = true
visible = false
layout_mode = 2
text = "Run Plan"
tooltip_text = "Execute the AI proposed plan step-by-step"

[node name="DiffPreviewPanel" type="VBoxContainer" parent="TabContainer/Chat"]
unique_name_in_owner = true
visible = false
layout_mode = 2
size_flags_vertical = 3

[node name="DiffLabel" type="Label" parent="TabContainer/Chat/DiffPreviewPanel"]
layout_mode = 2
text = "Script Diff Preview:"

[node name="DiffDisplay" type="RichTextLabel" parent="TabContainer/Chat/DiffPreviewPanel"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
bbcode_enabled = true
fit_content = false
scroll_following = true

[node name="DiffButtons" type="HBoxContainer" parent="TabContainer/Chat/DiffPreviewPanel"]
layout_mode = 2

[node name="ApplyDiffBtn" type="Button" parent="TabContainer/Chat/DiffPreviewPanel/DiffButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Apply Changes"
tooltip_text = "Accept these AI modifications and apply them to the file"

[node name="SkipDiffBtn" type="Button" parent="TabContainer/Chat/DiffPreviewPanel/DiffButtons"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Skip"
tooltip_text = "Discard these suggested changes"

[node name="InputHBox" type="HBoxContainer" parent="TabContainer/Chat"]
layout_mode = 2
custom_minimum_size = Vector2(0, 80)

[node name="InputField" type="TextEdit" parent="TabContainer/Chat/InputHBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
placeholder_text = "Ask Gamedev AI... (Shift+Enter to send)"
wrap_mode = 1

[node name="AddFileBtn" type="Button" parent="TabContainer/Chat/InputHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "üìé"
tooltip_text = "Attach an image, document, or audio file to your message"

[node name="SendButton" type="Button" parent="TabContainer/Chat/InputHBox"]
unique_name_in_owner = true
layout_mode = 2
text = "Send"
tooltip_text = "Send your message to the AI"

[node name="ImagePreviewScroll" type="ScrollContainer" parent="TabContainer/Chat"]
unique_name_in_owner = true
visible = false
layout_mode = 2
custom_minimum_size = Vector2(0, 100)
horizontal_scroll_mode = 2
vertical_scroll_mode = 0

[node name="ThumbnailList" type="HBoxContainer" parent="TabContainer/Chat/ImagePreviewScroll"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/separation = 10

[node name="FilePreviewContainer" type="HBoxContainer" parent="TabContainer/Chat"]
unique_name_in_owner = true
visible = false
layout_mode = 2

[node name="FilePreviewLabel" type="RichTextLabel" parent="TabContainer/Chat/FilePreviewContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
bbcode_enabled = true
text = "[color=cyan]Files attached:[/color] none"
fit_content = true

[node name="FileClearBtn" type="Button" parent="TabContainer/Chat/FilePreviewContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "X"
tooltip_text = "Remove all attached files"

[node name="ToggleContainer" type="HBoxContainer" parent="TabContainer/Chat"]
layout_mode = 2

[node name="ContextToggle" type="CheckButton" parent="TabContainer/Chat/ToggleContainer"]
unique_name_in_owner = true
layout_mode = 2
button_pressed = true
text = "Context"
tooltip_text = "Include the text of the currently open script in the AI prompt"

[node name="ScreenshotToggle" type="CheckButton" parent="TabContainer/Chat/ToggleContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Screenshot"
tooltip_text = "Take a screenshot of the editor and send it to the AI"


[node name="PlanFirstToggle" type="CheckButton" parent="TabContainer/Chat/ToggleContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Plan First"
tooltip_text = "Ask the AI to generate a step-by-step plan before executing."

[node name="WatchModeToggle" type="CheckButton" parent="TabContainer/Chat/ToggleContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Watch Mode"
tooltip_text = "Monitor console for new errors and auto-prompt fix."

[node name="Settings" type="VBoxContainer" parent="TabContainer"]
visible = false
layout_mode = 2
theme_type_variation = &"MarginContainer"
clip_contents = true

[node name="PresetBar" type="HBoxContainer" parent="TabContainer/Settings"]
layout_mode = 2

[node name="PresetLabel" type="Label" parent="TabContainer/Settings/PresetBar"]
layout_mode = 2
text = "Preset:"

[node name="PresetSelector" type="OptionButton" parent="TabContainer/Settings/PresetBar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3

[node name="AddPresetBtn" type="Button" parent="TabContainer/Settings/PresetBar"]
layout_mode = 2
text = "Add"
tooltip_text = "Add new preset"

[node name="EditPresetBtn" type="Button" parent="TabContainer/Settings/PresetBar"]
unique_name_in_owner = true
layout_mode = 2
text = "Edit"
tooltip_text = "Edit current preset"

[node name="DelPresetBtn" type="Button" parent="TabContainer/Settings/PresetBar"]
layout_mode = 2
text = "Del"
tooltip_text = "Delete current preset"

[node name="PresetEditPanel" type="VBoxContainer" parent="TabContainer/Settings"]
unique_name_in_owner = true
visible = false
layout_mode = 2

[node name="ConfigGrid" type="GridContainer" parent="TabContainer/Settings/PresetEditPanel"]
layout_mode = 2
columns = 2

[node name="NameLabel" type="Label" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
layout_mode = 2
text = "Preset Name:"

[node name="PresetNameInput" type="LineEdit" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
tooltip_text = "Press Enter to rename current preset"

[node name="ProviderLabel" type="Label" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
layout_mode = 2
text = "Provider:"

[node name="ProviderSelector" type="OptionButton" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
unique_name_in_owner = true
layout_mode = 2

[node name="ApiLabel" type="Label" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
layout_mode = 2
text = "API Key:"

[node name="ApiInput" type="LineEdit" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
secret = true

[node name="ModelLabel" type="Label" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
layout_mode = 2
text = "Model Name:"

[node name="ModelInput" type="LineEdit" parent="TabContainer/Settings/PresetEditPanel/ConfigGrid"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
placeholder_text = "gemini-1.5-pro or gpt-4o"

[node name="SettingsBar" type="HBoxContainer" parent="TabContainer/Settings/PresetEditPanel"]
unique_name_in_owner = true
visible = false
layout_mode = 2

[node name="UrlLabel" type="Label" parent="TabContainer/Settings/PresetEditPanel/SettingsBar"]
layout_mode = 2
text = "Base URL:"

[node name="UrlInput" type="LineEdit" parent="TabContainer/Settings/PresetEditPanel/SettingsBar"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
placeholder_text = "https://openrouter.ai/api/v1"

[node name="HBoxContainer" type="HBoxContainer" parent="TabContainer/Settings/PresetEditPanel"]
layout_mode = 2
alignment = 2

[node name="CloseEditBtn" type="Button" parent="TabContainer/Settings/PresetEditPanel/HBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Done Editing"

[node name="CustomPromptLabel" type="Label" parent="TabContainer/Settings"]
layout_mode = 2
text = "Custom Instructions (appended to system prompt):"

[node name="CustomPromptInput" type="TextEdit" parent="TabContainer/Settings"]
unique_name_in_owner = true
layout_mode = 2
custom_minimum_size = Vector2(0, 100)
size_flags_vertical = 3
placeholder_text = "e.g. Always respond in Portuguese. Focus on 2D platformer patterns..."
wrap_mode = 1
[node name="Git" type="VBoxContainer" parent="TabContainer"]
visible = false
layout_mode = 2

[node name="InitRepoBtn" type="Button" parent="TabContainer/Git"]
unique_name_in_owner = true
layout_mode = 2
text = "Initialize Repository"
tooltip_text = "Initialize a new local Git repository in your project folder"

[node name="RemoteContainer" type="HBoxContainer" parent="TabContainer/Git"]
unique_name_in_owner = true
layout_mode = 2

[node name="Label" type="Label" parent="TabContainer/Git/RemoteContainer"]
layout_mode = 2
text = "GitHub URL:"

[node name="RemoteUrlInput" type="LineEdit" parent="TabContainer/Git/RemoteContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
placeholder_text = "https://github.com/..."

[node name="SetRemoteBtn" type="Button" parent="TabContainer/Git/RemoteContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Save"
tooltip_text = "Set Remote Origin URL"

[node name="GitStatusLabel" type="RichTextLabel" parent="TabContainer/Git"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
bbcode_enabled = true
text = "Checking Git status..."

[node name="GitActionsContainer" type="HBoxContainer" parent="TabContainer/Git"]
layout_mode = 2

[node name="PullBtn" type="Button" parent="TabContainer/Git/GitActionsContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Pull"
tooltip_text = "Download and merge the latest changes from GitHub"

[node name="RefreshGitBtn" type="Button" parent="TabContainer/Git/GitActionsContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Refresh Status"
tooltip_text = "Refresh the list of changed files below"

[node name="CommitMsgContainer" type="VBoxContainer" parent="TabContainer/Git"]
layout_mode = 2

[node name="AutoGenerateBtn" type="Button" parent="TabContainer/Git/CommitMsgContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "‚ú® Auto-Generate Commit Message"
tooltip_text = "Use AI to analyze your changes and write a commit message automatically"

[node name="CommitMsgInput" type="TextEdit" parent="TabContainer/Git/CommitMsgContainer"]
unique_name_in_owner = true
custom_minimum_size = Vector2(0, 80)
layout_mode = 2
wrap_mode = 1
placeholder_text = "Enter commit message here..."

[node name="CommitSyncBtn" type="Button" parent="TabContainer/Git"]
unique_name_in_owner = true
layout_mode = 2
text = "Commit & Sync (Push)"
tooltip_text = "Save your changes locally (Commit) and upload them to GitHub (Push)"

[node name="HSeparator" type="HSeparator" parent="TabContainer/Git"]
layout_mode = 2
theme_override_constants/separation = 15

[node name="BranchContainer" type="HBoxContainer" parent="TabContainer/Git"]
unique_name_in_owner = true
layout_mode = 2

[node name="BranchLabel" type="RichTextLabel" parent="TabContainer/Git/BranchContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
bbcode_enabled = true
text = "Current Branch: [b]main[/b]"
fit_content = true

[node name="BranchNameInput" type="LineEdit" parent="TabContainer/Git/BranchContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
placeholder_text = "new-branch-name"

[node name="CheckoutBranchBtn" type="Button" parent="TabContainer/Git/BranchContainer"]
unique_name_in_owner = true
layout_mode = 2
text = "Create/Switch"
tooltip_text = "Creates a parallel 'timeline' (branch). Great for testing new mechanics without the risk of breaking your functional game."

[node name="AdvancedGitHBox" type="HBoxContainer" parent="TabContainer/Git"]
layout_mode = 2

[node name="UndoChangesBtn" type="Button" parent="TabContainer/Git/AdvancedGitHBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Undo Uncommitted Changes"
tooltip_text = "Discards all local edits that haven't been committed, reverting the project to its last locally saved version."

[node name="ForcePullBtn" type="Button" parent="TabContainer/Git/AdvancedGitHBox"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
text = "Force Pull Overwrite"
tooltip_text = "Completely replaces your project with the latest version saved on GitHub, ignoring any current local errors."

[node name="PollTimer" type="Timer" parent="."]
wait_time = 0.5
autostart = true

[node name="UndoConfirmDialog" type="ConfirmationDialog" parent="."]
unique_name_in_owner = true
title = "Undo Uncommitted Changes"
dialog_text = "Are you sure? This will permanently delete all current edits that have not been saved/committed to Git."

[node name="ForcePullConfirmDialog" type="ConfirmationDialog" parent="."]
unique_name_in_owner = true
title = "Force Pull Overwrite"
dialog_text = "WARNING: Are you sure? This will ignore your local edits and force the project to exactly match what is on GitHub today. You will lose any unpushed work!"

[node name="AddFileDialog" type="FileDialog" parent="."]
unique_name_in_owner = true
title = "Open a File"
size = Vector2i(600, 400)
ok_button_text = "Open"
file_mode = 0
access = 2
filters = PackedStringArray("*.png, *.jpg, *.jpeg, *.webp ; Images", "*.pdf, *.txt, *.md, *.csv, *.json, *.gd ; Documents", "*.mp3, *.wav, *.ogg ; Audio", "*.* ; All Files")

[node name="ImagePopupDialog" type="AcceptDialog" parent="."]
unique_name_in_owner = true
title = "Image Preview"
size = Vector2i(800, 600)

[node name="ScrollContainer" type="ScrollContainer" parent="ImagePopupDialog"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 8.0
offset_top = 8.0
offset_right = -8.0
offset_bottom = -49.0
grow_horizontal = 2
grow_vertical = 2

[node name="PopupTextureRect" type="TextureRect" parent="ImagePopupDialog/ScrollContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
expand_mode = 1
stretch_mode = 5

